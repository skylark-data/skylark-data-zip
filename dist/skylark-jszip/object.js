/**
 * skylark-jszip - A skylark wrapper for jszip.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./utf8","./utils","./stream/GenericWorker","./stream/StreamHelper","./defaults","./compressedObject","./zipObject","./generate"],function(e,t,r,i,n,s,o,a){"use strict";var l=function(e,i,a){var l,p=t.getTypeOf(i),h=t.extend(a||{},n);h.date=h.date||new Date,null!==h.compression&&(h.compression=h.compression.toUpperCase()),"string"==typeof h.unixPermissions&&(h.unixPermissions=parseInt(h.unixPermissions,8)),h.unixPermissions&&16384&h.unixPermissions&&(h.dir=!0),h.dosPermissions&&16&h.dosPermissions&&(h.dir=!0),h.dir&&(e=u(e)),h.createFolders&&(l=c(e))&&f.call(this,l,!0);var m="string"===p&&!1===h.binary&&!1===h.base64;a&&void 0!==a.binary||(h.binary=!m),(i instanceof s&&0===i.uncompressedSize||h.dir||!i||0===i.length)&&(h.base64=!1,h.binary=!0,i="",h.compression="STORE",p="string");var d=null;d=i instanceof s||i instanceof r?i:t.prepareContent(e,i,h.binary,h.optimizedBinaryString,h.base64);var g=new o(e,d,h);this.files[e]=g},c=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},u=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},f=function(e,t){return t=void 0!==t?t:n.createFolders,e=u(e),this.files[e]||l.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function p(e){return"[object RegExp]"===Object.prototype.toString.call(e)}return{load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,i;for(t in this.files)i=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,i)},filter:function(e){var t=[];return this.forEach(function(r,i){e(r,i)&&t.push(i)}),t},file:function(e,t,r){if(1===arguments.length){if(p(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var n=this.files[this.root+e];return n&&!n.dir?n:null}return e=this.root+e,l.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(p(e))return this.filter(function(t,r){return r.dir&&e.test(t)});var t=this.root+e,r=f.call(this,t),i=this.clone();return i.root=r.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e}),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(n){var s,o={};try{if((o=t.extend(n||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:e.utf8encode})).type=o.type.toLowerCase(),o.compression=o.compression.toUpperCase(),"binarystring"===o.type&&(o.type="string"),!o.type)throw new Error("No output type specified.");t.checkSupport(o.type),"darwin"!==o.platform&&"freebsd"!==o.platform&&"linux"!==o.platform&&"sunos"!==o.platform||(o.platform="UNIX"),"win32"===o.platform&&(o.platform="DOS");var l=o.comment||this.comment||"";s=a.generateWorker(this,o,l)}catch(e){(s=new r("error")).error(e)}return new i(s,o.type||"string",o.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}}});
//# sourceMappingURL=sourcemaps/object.js.map
